name: polyglot
description: Multi-language workflow demonstrating all 4 Ork execution methods

types:
  NumbersOutput:
    numbers: [int]
  RustLibraryOutput:
    tripled: [int]
    sum: int
  RustProcessSdkOutput:
    total: int
    tripled: [int]
  RustProcessRawOutput:
    sum: int
    count: int
  FinalOutput:
    summary: str
    total: int
    final_value: int
    tripled_numbers: [int]

tasks:
  py_generate:
    executor: python
    file: polyglot.py
    function: generate_numbers
    input_type:
      count: int
    output_type: types.NumbersOutput
    inputs:
      count:
        const: 5

  rust_library:
    executor: library
    file: rust_tasks/target/debug/libpolyglot_rust_lib.so
    depends_on: [py_generate]
    input_type:
      py_generate: types.NumbersOutput
    output_type: types.RustLibraryOutput
    inputs:
      py_generate:
        ref: tasks.py_generate.output

  rust_process_sdk:
    executor: process
    command: rust_tasks/target/debug/process_sdk
    depends_on: [rust_library]
    input_type:
      rust_library: types.RustLibraryOutput
    output_type: types.RustProcessSdkOutput
    inputs:
      rust_library:
        ref: tasks.rust_library.output

  rust_process_raw:
    executor: process
    command: rust_tasks/target/debug/process_raw
    depends_on: [py_generate]
    input_type:
      py_generate: types.NumbersOutput
    output_type: types.RustProcessRawOutput
    inputs:
      py_generate:
        ref: tasks.py_generate.output

  py_format:
    executor: python
    file: polyglot.py
    function: format_result
    depends_on: [rust_process_sdk]
    input_type:
      multiplier: int
      rust_process_sdk: types.RustProcessSdkOutput
    output_type: types.FinalOutput
    inputs:
      multiplier:
        const: 10
      rust_process_sdk:
        ref: tasks.rust_process_sdk.output
